<%- include('./partials/header') %>
     <!-- START Wrapper -->
     <div class="wrapper">
<%- include('./partials/adminHeader') %>

<%- include('./partials/sidebar') %>

          <!-- ==================================================== -->
          <!-- Start right Content here -->
          <!-- ==================================================== -->
          <div class="page-content">

               <!-- Start Container Fluid -->
               <div class="container-fluid">

                    <!-- Start here.... -->
                    <div class="row">
                         <div class="col-xxl-12">
                              <div class="row">
                                   <!-- <div class="col-12">
                                        <div class="alert alert-primary text-truncate mb-3" role="alert">
                                             We regret to inform you that our server is currently experiencing technical difficulties.
                                        </div>
                                   </div> -->

                                   <div class="col-md-4">
                                        <div class="card overflow-hidden">
                                             <div class="card-body">
                                                  <div class="row">
                                                       <div class="col-6">
                                                            <div class="avatar-md bg-soft-primary rounded">
                                                                 <iconify-icon icon="solar:cart-5-bold-duotone" class="avatar-title fs-32 text-primary"></iconify-icon>
                                                            </div>
                                                       </div> <!-- end col -->
                                                       <div class="col-6 text-end">
                                                            <p class="text-muted mb-0 text-truncate">Total Orders</p>
                                                            <h3 class="text-dark mt-1 mb-0"><%= totalOrders %></h3>
                                                       </div> <!-- end col -->
                                                  </div> <!-- end row-->
                                             </div> <!-- end card body -->
                                             <!-- <div class="card-footer py-2 bg-light bg-opacity-50">
                                                  <div class="d-flex align-items-center justify-content-between">
                                                       <div>
                                                            <span class="text-success"> <i class="bx bxs-up-arrow fs-12"></i> 2.3%</span>
                                                            <span class="text-muted ms-1 fs-12">Last Week</span>
                                                       </div>
                                                       <a href="#!" class="text-reset fw-semibold fs-12">View More</a>
                                                  </div>
                                             </div> end card body -->
                                        </div> <!-- end card -->
                                   </div> <!-- end col -->
                                   <div class="col-md-4">
                                        <div class="card overflow-hidden">
                                             <div class="card-body">
                                                  <div class="row">
                                                       <div class="col-6">
                                                            <div class="avatar-md bg-soft-primary rounded">
                                                                 <i class="bx bx-award avatar-title fs-24 text-primary"></i>
                                                            </div>
                                                       </div> <!-- end col -->
                                                       <div class="col-6 text-end">
                                                            <p class="text-muted mb-0 text-truncate">Total Customers</p>
                                                            <h3 class="text-dark mt-1 mb-0"><%= totalCustomers %></h3>
                                                       </div> <!-- end col -->
                                                  </div> <!-- end row-->
                                             </div> <!-- end card body -->
                                             <!-- <div class="card-footer py-2 bg-light bg-opacity-50">
                                                  <div class="d-flex align-items-center justify-content-between">
                                                       <div>
                                                            <span class="text-success"> <i class="bx bxs-up-arrow fs-12"></i> 8.1%</span>
                                                            <span class="text-muted ms-1 fs-12">Last Month</span>
                                                       </div>
                                                       <a href="#!" class="text-reset fw-semibold fs-12">View More</a>
                                                  </div>
                                             </div> end card body -->
                                        </div> <!-- end card -->
                                   </div> 
                                   
                                   
                                    <div class="col-md-4">
                                        <div class="card overflow-hidden">
                                             <div class="card-body">
                                                  <div class="row">
                                                       <div class="col-6">
                                                            <div class="avatar-md bg-soft-primary rounded">
                                                                 <i class="bx bx-award avatar-title fs-24 text-primary"></i>
                                                            </div>
                                                       </div> <!-- end col -->
                                                       <div class="col-6 text-end">
                                                            <p class="text-muted mb-0 text-truncate">Total Products</p>
                                                            <h3 class="text-dark mt-1 mb-0"><%= totalProducts %></h3>
                                                       </div> <!-- end col -->
                                                  </div> <!-- end row-->
                                             </div> <!-- end card body -->
                                             <!-- <div class="card-footer py-2 bg-light bg-opacity-50">
                                                  <div class="d-flex align-items-center justify-content-between">
                                                       <div>
                                                            <span class="text-success"> <i class="bx bxs-up-arrow fs-12"></i> 8.1%</span>
                                                            <span class="text-muted ms-1 fs-12">Last Month</span>
                                                       </div>
                                                       <a href="#!" class="text-reset fw-semibold fs-12">View More</a>
                                                  </div>
                                             </div> end card body -->
                                        </div> <!-- end card -->
                                   </div><!-- end col -->
                                   <!-- <div class="col-md-6">
                                        <div class="card overflow-hidden">
                                             <div class="card-body">
                                                  <div class="row">
                                                       <div class="col-6">
                                                            <div class="avatar-md bg-soft-primary rounded">
                                                                 <i class="bx bxs-backpack avatar-title fs-24 text-primary"></i>
                                                            </div>
                                                       </div> 
                                                       <div class="col-6 text-end">
                                                            <p class="text-muted mb-0 text-truncate">Deals</p>
                                                            <h3 class="text-dark mt-1 mb-0">976</h3>
                                                       </div> 
                                                  </div> 
                                             </div> 
                                             <div class="card-footer py-2 bg-light bg-opacity-50">
                                                  <div class="d-flex align-items-center justify-content-between">
                                                       <div>
                                                            <span class="text-danger"> <i class="bx bxs-down-arrow fs-12"></i> 0.3%</span>
                                                            <span class="text-muted ms-1 fs-12">Last Month</span>
                                                       </div>
                                                       <a href="#!" class="text-reset fw-semibold fs-12">View More</a>
                                                  </div>
                                             </div> 
                                        </div> 
                                   </div> -->
                                    <!-- end col -->
                                   <!-- <div class="col-md-6">
                                        <div class="card overflow-hidden">
                                             <div class="card-body">
                                                  <div class="row">
                                                       <div class="col-6">
                                                            <div class="avatar-md bg-soft-primary rounded">
                                                                 <i class="bx bx-dollar-circle avatar-title text-primary fs-24"></i>
                                                            </div> -->
                                                       <!-- </div>
                                                       <div class="col-6 text-end">
                                                            <p class="text-muted mb-0 text-truncate">Booked Revenue</p>
                                                            <h3 class="text-dark mt-1 mb-0">$123.6k</h3> -->
                                                       <!-- </div> 
                                                  </div> 
                                             </div> 
                                             <div class="card-footer py-2 bg-light bg-opacity-50">
                                                  <div class="d-flex align-items-center justify-content-between">
                                                       <div>
                                                            <span class="text-danger"> <i class="bx bxs-down-arrow fs-12"></i> 10.6%</span>
                                                            <span class="text-muted ms-1 fs-12">Last Month</span>
                                                       </div>
                                                       <a href="#!" class="text-reset fw-semibold fs-12">View More</a>
                                                  </div> -->
                                             <!-- </div> -->
                                              <!-- end card body -->
                                         <!-- end card -->
                                   <!-- </div>  -->
                                   <!-- end col -->
                              </div> <!-- end row -->
                         </div> <!-- end col -->

                       <!-- end col -->
                    </div> <!-- end row -->

                   

                    <div class="row">
                         <div class="col">
                              <div class="card">
                                   <div class="card-body">
                                        <div class="d-flex align-items-center justify-content-between">
                                             <h4 class="card-title">
                                                  Recent Orders
                                             </h4>

                                             <!-- <a href="/" class="btn btn-sm btn-soft-primary">
                                                  <i class="bx bx-plus me-1"></i>Create Order
                                             </a> -->
                                        </div>
                                   </div>
                                   <!-- end card body -->
                                   <div class="table-responsive table-centered">
                                        <table class="table mb-0">
                                             <thead class="bg-light bg-opacity-50">
                                                  <tr>
                                                                 <th>Order ID</th>
                                                                 <th>Created at</th>
                                                                 <th>Customer ID</th>
                                                                 <th>Items</th>
                                                                 <th>Total</th>
                                                                 <th>Payment Status</th>
                                                                 <th>Order Status</th>
                                                            </tr>
                                             </thead>
                                             <!-- end thead-->
                                             <tbody>
                                                            <% if(orders.length > 0) { %>
                                                            <% orders.forEach(order => { %>
                                                            <tr>
                                                                 <td><%= order.orderId %></td>
                                                                 <td><%= order.createdAt.toLocaleDateString('en-IN') %></td>
                                                                 <td>
                                                                      <a href="/admin/user-details?id=<%= order.userId._id %>"><%= order.userId.userId %></a>
                                                                      
                                                                 </td>
                                                                  <td>
          <ul class="list-unstyled mb-0">
           <% order.items.forEach(item => { %>
  <li>
    <%= (item.productId && item.productId.name) ? item.productId.name : 'Product' %> x <%= item.quantity %> - ₹<%= item.subtotal?.toFixed(2) || '0.00' %>
  </li>
<% }) %>

          </ul>
        </td>
        <td>₹<%= order.total.toFixed(2) %></td>
                                                                 <td><%= order.paymentStatus %></td>
                                                                 <td><%= order.status %></td>
                                                            </tr>
                                                            <% }) %>
                                                            <% } else { %>
                                                            <tr>
                                                                 <td colspan="9" class="text-center">No orders found</td>
                                                            </tr>
                                                            <% } %>
                                                       </tbody>
                                             <!-- end tbody -->
                                        </table>
                                        <!-- end table -->
                                   </div>
                                   <!-- table responsive -->

                                   <div class="card-footer border-top">
                                        <div class="row g-3">
                                             <div class="col-sm">
                                                  <div class="col-sm">
                                                  <div class="text-muted">
                                                  Showing
                                                  <span class="fw-semibold"><%= orders.length %></span>
                                                  of
                                                  <span class="fw-semibold"><%= totalOrders %></span>
                                                  orders
                                                  </div>
                                                  </div>

                                             </div>

                                             <div class="col-sm-auto">
                                                  <ul class="pagination m-0" id="pagination"></ul>
                                                  <!-- <ul class="pagination m-0">
                                                       <li class="page-item">
                                                            <a href="#" class="page-link"><i class="bx bx-left-arrow-alt"></i></a>
                                                       </li>
                                                       <li class="page-item active">
                                                            <a href="#" class="page-link">1</a>
                                                       </li>
                                                       <li class="page-item">
                                                            <a href="#" class="page-link">2</a>
                                                       </li>
                                                       <li class="page-item">
                                                            <a href="#" class="page-link">3</a>
                                                       </li>
                                                       <li class="page-item">
                                                            <a href="#" class="page-link"><i class="bx bx-right-arrow-alt"></i></a>
                                                       </li>
                                                  </ul> -->
                                             </div>
                                        </div>
                                   </div>
                              </div>
                              <!-- end card -->
                         </div>
                         <!-- end col -->
                    </div> <!-- end row -->

               </div>
               <!-- End Container Fluid -->

               <!-- ========== Footer Start ========== -->
             
               <!-- ========== Footer End ========== -->

          </div>
          <!-- ==================================================== -->
          <!-- End Page Content -->
          <!-- ==================================================== -->

<%- include('./partials/footer') %>
     </div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const totalOrders = 50; // This would come from your backend/API
    const itemsPerPage = 10;
    const totalPages = Math.ceil(totalOrders / itemsPerPage);
    const pagination = document.getElementById('pagination');
    let currentPage = 1;

    function renderPagination(currentPage) {
      pagination.innerHTML = '';

      // Previous Button
      const prevBtn = document.createElement('li');
      prevBtn.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
      prevBtn.innerHTML = `<a href="#" class="page-link"><i class="bx bx-left-arrow-alt"></i></a>`;
      prevBtn.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          renderPagination(currentPage);
          loadOrders(currentPage); // Your custom data loading logic
        }
      });
      pagination.appendChild(prevBtn);

      // Page Numbers
      for (let i = 1; i <= totalPages; i++) {
        const pageItem = document.createElement('li');
        pageItem.className = `page-item ${i === currentPage ? 'active' : ''}`;
        pageItem.innerHTML = `<a href="#" class="page-link">${i}</a>`;
        pageItem.addEventListener('click', () => {
          currentPage = i;
          renderPagination(currentPage);
          loadOrders(currentPage);
        });
        pagination.appendChild(pageItem);
      }

      // Next Button
      const nextBtn = document.createElement('li');
      nextBtn.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
      nextBtn.innerHTML = `<a href="#" class="page-link"><i class="bx bx-right-arrow-alt"></i></a>`;
      nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          renderPagination(currentPage);
          loadOrders(currentPage);
        }
      });
      pagination.appendChild(nextBtn);
    }

    function loadOrders(page) {
      // ⚠️ Replace this with your AJAX call or DOM update logic
      console.log(`Loading orders for page ${page}`);
    }

    // Initialize
    renderPagination(currentPage);
    loadOrders(currentPage);
  });
</script>
